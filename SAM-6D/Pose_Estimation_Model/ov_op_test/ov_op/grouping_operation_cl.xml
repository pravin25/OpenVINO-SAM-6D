<CustomLayer name="GroupingOperation" type="SimpleGPU" version="1">
    <Kernel entry="grouping_kernel">
        <Source filename="grouping_operation.cl" />
    </Kernel>

    <Buffers>
        <Tensor arg-index="0" type="input" port-index="0" />
        <Tensor arg-index="1" type="input" port-index="1" />
        <Tensor arg-index="2" type="output" port-index="0" format="bfyx" />
    </Buffers>

    <CompilerOptions options="-cl-mad-enable"/>
    
    <!-- Dynamically computed work sizes -->
    <!-- <WorkSizes global="B,F,1" local="1,1,1" /> -->
    <!-- notes:
        Global work sizes should be total number of output elements:
        B * C * NPOINT
        Local size can be tuned for your hardware; keeping it 64 is typical
        b = batch size (B)
        f = feature channels (C)
        y = height or dimension (NPOINT)
        x = width or dimension (NSAMPLE)
    -->

    <WorkSizes global="b*f*y*x,1,1" local="64,1,1" />
</CustomLayer>
